<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>關鍵詞比較與頻率分析工具</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            max-width: 980px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 10px;
        }
        textarea {
            width: 100%;
            height: 200px;
            margin-bottom: 15px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-family: monospace;
        }
        button {
            background-color: #2ea44f;
            border: 1px solid rgba(27, 31, 35, 0.15);
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            padding: 6px 16px;
            margin-bottom: 20px;
        }
        button:hover {
            background-color: #2c974b;
        }
        .result {
            white-space: pre-wrap;
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 15px;
            font-family: monospace;
            min-height: 100px;
            margin-bottom: 15px;
        }
        .container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .input-container {
            flex: 1;
        }
        .result-container {
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }
        .copy-button {
            background-color: #0366d6;
            margin-top: 10px;
            float: right;
        }
        .copy-button:hover {
            background-color: #0258b8;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f6f8fa;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .tab-container {
            margin-bottom: 15px;
        }
        .tab {
            background-color: #f6f8fa;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 6px 6px 0 0;
            padding: 8px 12px;
            cursor: pointer;
            display: inline-block;
            margin-right: 5px;
        }
        .tab.active {
            background-color: #fff;
            font-weight: bold;
        }
        .tab-content {
            display: none;
            border: 1px solid #ddd;
            border-radius: 0 6px 6px 6px;
            padding: 15px;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <h1>關鍵詞比較與頻率分析工具</h1>
    <p>在下方輸入兩份文字，系統會自動比較並找出重複的關鍵詞及其在兩部分的出現頻率。每個關鍵詞應該獨立一行，行尾數字將被忽略。</p>
    
    <div class="container">
        <div class="input-container">
            <h2>第一部分</h2>
            <textarea id="part1" placeholder="請輸入第一部分文字，每行一個關鍵詞"></textarea>
        </div>
        <div class="input-container">
            <h2>第二部分</h2>
            <textarea id="part2" placeholder="請輸入第二部分文字，每行一個關鍵詞"></textarea>
        </div>
    </div>
    
    <button id="compare">比較關鍵詞</button>
    
    <div class="result-container">
        <h2>分析結果</h2>
        
        <div class="tab-container">
            <div class="tab active" data-tab="simple">簡易列表</div>
            <div class="tab" data-tab="detailed">頻率分析表</div>
        </div>
        
        <div id="simple-result" class="tab-content active">
            <h3>重複的關鍵詞</h3>
            <div id="result" class="result"></div>
            <button id="copy-simple" class="copy-button">複製結果</button>
        </div>
        
        <div id="detailed-result" class="tab-content">
            <h3>重複關鍵詞與頻率分析</h3>
            <div id="frequency-table-container">
                <table id="frequency-table">
                    <thead>
                        <tr>
                            <th>關鍵詞</th>
                            <th>第一部分出現頻率</th>
                            <th>第二部分出現頻率</th>
                        </tr>
                    </thead>
                    <tbody id="frequency-data"></tbody>
                </table>
            </div>
            <button id="copy-detailed" class="copy-button">複製結果</button>
        </div>
    </div>

    <script>
        function removeTrailingNumbers(text) {
            // 分割每行
            const lines = text.split('\n');
            const cleanedLines = [];
            
            for (let line of lines) {
                // 使用正則表達式移除行尾數字
                const cleaned = line.replace(/\s+\d+(?:\s+\d+)*$/, '').trim();
                if (cleaned) {
                    cleanedLines.push(cleaned);
                }
            }
            
            return cleanedLines;
        }
        
        function countFrequency(items) {
            const frequency = {};
            for (let item of items) {
                frequency[item] = (frequency[item] || 0) + 1;
            }
            return frequency;
        }
        
        document.getElementById('compare').addEventListener('click', function() {
            // 獲取輸入
            const part1 = document.getElementById('part1').value;
            const part2 = document.getElementById('part2').value;
            
            // 處理兩部分資料
            const list1 = removeTrailingNumbers(part1);
            const list2 = removeTrailingNumbers(part2);
            
            // 計算頻率
            const freq1 = countFrequency(list1);
            const freq2 = countFrequency(list2);
            
            // 找出重複字詞
            const uniqueWords1 = new Set(list1);
            const uniqueWords2 = new Set(list2);
            const commonWords = Array.from(uniqueWords1).filter(word => uniqueWords2.has(word)).sort();
            
            // 更新簡易結果
            const resultArea = document.getElementById('result');
            if (commonWords.length > 0) {
                resultArea.textContent = "重複的關鍵詞：\n" + commonWords.join('\n');
            } else {
                resultArea.textContent = "沒有找到重複的關鍵詞。";
            }
            
            // 更新頻率分析表
            const tableBody = document.getElementById('frequency-data');
            tableBody.innerHTML = '';
            
            if (commonWords.length > 0) {
                for (let word of commonWords) {
                    const row = document.createElement('tr');
                    
                    const wordCell = document.createElement('td');
                    wordCell.textContent = word;
                    row.appendChild(wordCell);
                    
                    const freq1Cell = document.createElement('td');
                    freq1Cell.textContent = freq1[word] || 0;
                    row.appendChild(freq1Cell);
                    
                    const freq2Cell = document.createElement('td');
                    freq2Cell.textContent = freq2[word] || 0;
                    row.appendChild(freq2Cell);
                    
                    tableBody.appendChild(row);
                }
            } else {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.textContent = "沒有找到重複的關鍵詞。";
                cell.colSpan = 3;
                row.appendChild(cell);
                tableBody.appendChild(row);
            }
        });
        
        // 複製簡易結果
        document.getElementById('copy-simple').addEventListener('click', function() {
            const resultText = document.getElementById('result').textContent;
            navigator.clipboard.writeText(resultText).then(function() {
                alert('已複製到剪貼簿！');
            }, function() {
                alert('複製失敗，請手動複製。');
            });
        });
        
        // 複製詳細結果
        document.getElementById('copy-detailed').addEventListener('click', function() {
            const table = document.getElementById('frequency-table');
            const rows = table.querySelectorAll('tr');
            let text = "關鍵詞\t第一部分出現頻率\t第二部分出現頻率\n";
            
            for (let i = 1; i < rows.length; i++) { // 跳過標題行
                const cells = rows[i].querySelectorAll('td');
                if (cells.length === 3) {
                    text += `${cells[0].textContent}\t${cells[1].textContent}\t${cells[2].textContent}\n`;
                }
            }
            
            navigator.clipboard.writeText(text).then(function() {
                alert('已複製到剪貼簿！');
            }, function() {
                alert('複製失敗，請手動複製。');
            });
        });
        
        // 標籤切換功能
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 移除所有標籤的active類
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                // 給當前點擊的標籤添加active類
                this.classList.add('active');
                
                // 隱藏所有內容
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                // 顯示對應的內容
                document.getElementById(`${this.dataset.tab}-result`).classList.add('active');
            });
        });
    </script>
</body>
</html>
